!function(a){"function"==typeof define&&define.amd?define(["angular","spinjs"],a):"object"==typeof exports?a(require("angular"),require("spinjs")):a(window.angular,window.Spinner)}(function(a,b){"use strict";function c(b){var d=!1,e=1;return"boolean"==typeof b&&(d=b,b=arguments[1]||{},e++),a.forEach([].slice.call(arguments,e),function(e){var f,g,h,i,j;for(i in e)j=b[i],h=e[i],b!==h&&(d&&h&&(a.isObject(h)||(f=a.isArray(h)))?(g=f?j&&a.isArray(j)?j:[]:j&&a.isObject(j)?j:{},b[i]=c(d,g,h)):void 0!==h&&(b[i]=h))}),b}a.module("darthwade.loading",[]).value("loadingOptions",{active:!1,text:"Loading...",className:"",overlay:!0,threshold:0,spinner:!0,spinnerOptions:{lines:12,length:7,width:4,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:2,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"dw-spinner",top:"auto",left:"auto",position:"relative"}}).service("$loading",["$rootScope","loadingOptions",function(a,b){var d=this;d.setDefaultOptions=function(a){c(!0,b,a)},d.start=function(b){a.$evalAsync(function(){a.$broadcast("$loadingStart",b)})},d.update=function(b,c){a.$evalAsync(function(){a.$broadcast("$loadingUpdate",b,c)})},d.finish=function(b){a.$evalAsync(function(){a.$broadcast("$loadingFinish",b)})}}]).directive("dwLoading",["$rootScope","loadingOptions","$timeout",function(d,e,f){return{link:function(g,h,i){var j,k,l,m,n,o,p,q=null,r=i.dwLoading||!1,s=function(){var a=o?0:e.threshold;p=f(function(){k&&k.addClass("dw-loading-active"),q&&q.spin(m[0])},a)},t=function(d){u(),j=c(!0,{},e,d),l=a.element("<div></div>").addClass("dw-loading-body"),k=a.element("<div></div>").addClass("dw-loading").append(l),j.overlay&&k.addClass("dw-loading-overlay"),j.className&&k.addClass(j.className),j.spinner&&(m=a.element("<div></div>").addClass("dw-loading-spinner"),l.append(m),q=new b(j.spinnerOptions)),j.text&&(n=a.element("<div></div>").addClass("dw-loading-text").text(j.text),l.append(n)),h.append(k),(j.active||!r||o)&&s()},u=function(){k&&k.removeClass("dw-loading-active"),q&&q.stop(),p&&f.cancel(p)};g.$watch(i.dwLoadingOptions,function(a){t(a)},!0),d.$on("$loadingStart",function(a,b){b===r&&s()}),d.$on("$loadingUpdate",function(a,b,c){b===r&&(o=!0,t(c))}),d.$on("$loadingFinish",function(a,b){b===r&&(o=!1,u())}),g.$on("$destroy",function(){u(),q=null})}}}])});